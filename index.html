<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>SAFARE</title>
  <style>
    body {
      margin: 0;
      font-family: 'Arial', sans-serif;
      background-color: #ffffff;
    }
    #map-container {
      background-color: #001f3f;
      padding: 20px;
    }
    #map { height: 600px; }
    h1, h2, h3 {
      margin: 16px;
    }
    .info-card, .quiz-card {
      background-color: white;
      color: #000;
      border-radius: 8px;
      padding: 16px;
      margin: 20px auto;
      max-width: 900px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .quiz-card {
      text-align: center;
    }
    .quiz-card button {
      margin: 10px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
    .leaflet-popup-content {
      font-size: 14px;
    }
    a {
      color: black;
      text-decoration: underline;
    }
    ul {
      list-style: disc;
      padding-left: 20px;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <div id="map-container">
    <h1 style="color: white; text-align: center;">SAFARE</h1>
    <p style="color: white; text-align: center;">세계를 안전하게, SAFARE와 함께</p>
    <div id="map"></div>
  </div>

  <div class="info-card">
    <h2>현 국제 범죄 및 분쟁 현황</h2>
    <ul id="news-list"><li>뉴스 로딩 중...</li></ul>
  </div>

  <div class="info-card">
    <h2>주요 국가 별 위험 상황</h2>
    <ul id="risk-list"><li>데이터 로딩 중...</li></ul>
  </div>

  <div class="quiz-card" id="quiz-section">
    <h3 id="quiz-question">퀴즈가 곧 시작됩니다!</h3>
    <button onclick="submitAnswer(true)">O</button>
    <button onclick="submitAnswer(false)">X</button>
    <p id="quiz-result"></p>
  </div>

  <script>
    var map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png', {
      maxZoom: 18,
      attribution: '© OpenStreetMap'
    }).addTo(map);

    var dangerCountries = [
      { name: "미국", lat: 37.0902, lng: -95.7129, info: "총기 사고 빈번함. 사망자 수 지속 증가 중. 정부 대책 절실함." },
      { name: "브라질", lat: -14.2350, lng: -51.9253, info: "갱단 활동 활발함. 치안 불안정 심각. 시민 안전 보장 필요함." },
      { name: "러시아-우크라이나", lat: 48.3794, lng: 31.1656, info: "전쟁 장기화됨. 민간 피해 크고 사회 기반 붕괴 중. 국제 평화 중재 필요함." },
      { name: "남아프리카공화국", lat: -30.5595, lng: 22.9375, info: "강력 범죄 잦음. 강도, 살인 등 높은 수준. 치안 강화가 시급함." }
    ];

    dangerCountries.forEach(function(country) {
      L.marker([country.lat, country.lng])
        .addTo(map)
        .bindPopup("📍 <b>" + country.name + "</b><br>" + country.info);
    });

    const newsItems = [
      '<a href="#">우크라이나 전쟁 지속 중 - 민간 피해 심각</a>',
      '<a href="#">브라질 갱단 활동 증가 - 시민 불안 고조</a>',
      '<a href="#">멕시코 마약 카르텔 분쟁 격화</a>',
      '<a href="#">미국 총기 사고 급증 - 규제 필요성 대두</a>',
      '<a href="#">인도 보이스피싱 피해자 다수 발생</a>',
      '<a href="#">러시아 해커들, 글로벌 사이버 공격</a>'
    ];

    const riskItems = [
      '<a href="#">나이지리아 테러 위험 지속</a>',
      '<a href="#">프랑스 테러 경계 수준 강화</a>',
      '<a href="#">남아공 강력 범죄 발생률 증가</a>',
      '<a href="#">호주 인신매매 조직 적발</a>'
    ];

    function rotateContent(listId, items) {
      let index = 0;
      const element = document.getElementById(listId);
      setInterval(() => {
        const newList = "<li>" + items[index % items.length] + "</li>";
        element.innerHTML = newList;
        index++;
      }, 15000);
    }

    rotateContent("news-list", newsItems);
    rotateContent("risk-list", riskItems);

    const allQuestions = [
      {
        q: "미국은 총기 사고가 많다. (O/X)", correct: true,
        correctText: "맞음! 총기 규제 논쟁 지속됨.",
        wrongText: "틀림! 실제로 매년 수천 명 사망함.",
        explanation: "총기 사건은 매년 수천 건 이상. 예: 라스베이거스 총기 난사 사건(2017).",
        link: "https://en.wikipedia.org/wiki/2017_Las_Vegas_shooting"
      },
      {
        q: "브라질은 갱단 활동이 없다. (O/X)", correct: false,
        correctText: "맞음! 갱단 존재함.",
        wrongText: "틀림! 거대 갱단 PCC 존재. 폭력 문제 지속.",
        explanation: "PCC 등 조직이 마약 거래, 폭력 주도. 도시 치안 악화 중.",
        link: "https://en.wikipedia.org/wiki/Primeiro_Comando_da_Capital"
      },
      {
        q: "러시아와 우크라이나는 평화 협정을 체결했다. (O/X)", correct: false,
        correctText: "맞음! 전쟁은 여전히 진행 중.",
        wrongText: "틀림! 현재도 전쟁 중이며 협정 없음.",
        explanation: "2022년부터 시작된 전쟁. 민간 피해 커짐.",
        link: "https://en.wikipedia.org/wiki/Russian_invasion_of_Ukraine"
      }
    ];

    function getRandomQuestions(arr, num) {
      const shuffled = arr.slice().sort(() => 0.5 - Math.random());
      return shuffled.slice(0, num);
    }

    let quizQuestions = getRandomQuestions(allQuestions, 3);
    let current = 0;
    let score = 0;

    window.onload = () => {
      document.getElementById("quiz-question").textContent = quizQuestions[0].q;
    };

    function submitAnswer(userAnswer) {
      const result = document.getElementById("quiz-result");
      const q = quizQuestions[current];
      if (userAnswer === q.correct) {
        score++;
        result.innerHTML = q.correctText + "<br><small>" + q.explanation + "</small>";
        result.style.color = "#00cc88";
      } else {
        result.innerHTML = q.wrongText + "<br><a href='" + q.link + "' target='_blank'>자세히 보기</a><br><small>" + q.explanation + "</small>";
        result.style.color = "#ff4444";
      }

      current++;
      if (current < quizQuestions.length) {
        setTimeout(() => {
          result.innerHTML = "";
          document.getElementById("quiz-question").textContent = quizQuestions[current].q;
        }, 2500);
      } else {
        setTimeout(() => {
          let comment = score === quizQuestions.length ? "완벽해요!" : score >= 2 ? "잘했어요!" : "더 알아봐요!";
          document.getElementById("quiz-section").innerHTML =
            `<h3>퀴즈 완료!</h3><p>총 점수: ${score} / ${quizQuestions.length}점</p><p>${comment}</p>`;
        }, 3000);
      }
    }
  </script>
</body>
</html>
